---

title: Helper functions for processing data and basic transforms
keywords: fastai
sidebar: home_sidebar

summary: "Functions for getting, splitting, and labeling data, as well as generic transforms"
---
<!--


#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: dev/06_data_transforms.ipynb
# instructions: https://docs.fast.ai/gen_doc_main.html

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Get,-split,-and-label">Get, split, and label<a class="anchor-link" href="#Get,-split,-and-label">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For most data source creation we need functions to get a list of items, split them in to train/valid sets, and label them. fastai provides functions to make each of these steps easy (especially when combined with <code>fastai.data.blocks</code>).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Get">Get<a class="anchor-link" href="#Get">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we'll look at functions that <em>get</em> a list of items (generally file names).</p>
<p>We'll use <em>tiny MNIST</em> (a subset of MNIST with just two classes, <code>7</code>s and <code>3</code>s) for our examples/tests throughout this page.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST_TINY</span><span class="p">)</span>
<span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#2) [/home/sgugger/git/fastai_dev/dev/data/mnist_tiny/train/3,/home/sgugger/git/fastai_dev/dev/data/mnist_tiny/train/7]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_files" class="doc_header"><code>get_files</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L26" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_files</code>(<strong><code>path</code></strong>, <strong><code>extensions</code></strong>=<em><code>None</code></em>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>folders</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Get all the files in <code>path</code> with optional <code>extensions</code>, optionally with <code>recurse</code>, only in <code>folders</code>, if specified.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is the most general way to grab a bunch of file names from disk. If you pass <code>extensions</code> (including the <code>.</code>) then returned file names are filtered by that list. Only those files directly in <code>path</code> are included, unless you pass <code>recurse</code>, in which case all child folders are also searched recursively. <code>folders</code> is an optional list of directories to limit the search to.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t3</span> <span class="o">=</span> <span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">t7</span> <span class="o">=</span> <span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">t</span>  <span class="o">=</span> <span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">t3</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">t7</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.jpg&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span><span class="mi">0</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">folders</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">)))</span>
<span class="n">t</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#709) [/home/sgugger/git/fastai_dev/dev/data/mnist_tiny/train/3/8055.png,/home/sgugger/git/fastai_dev/dev/data/mnist_tiny/train/3/9466.png,/home/sgugger/git/fastai_dev/dev/data/mnist_tiny/train/3/7778.png,/home/sgugger/git/fastai_dev/dev/data/mnist_tiny/train/3/8824.png,/home/sgugger/git/fastai_dev/dev/data/mnist_tiny/train/3/8228.png,/home/sgugger/git/fastai_dev/dev/data/mnist_tiny/train/3/9620.png,/home/sgugger/git/fastai_dev/dev/data/mnist_tiny/train/3/8790.png,/home/sgugger/git/fastai_dev/dev/data/mnist_tiny/train/3/7497.png,/home/sgugger/git/fastai_dev/dev/data/mnist_tiny/train/3/7383.png,/home/sgugger/git/fastai_dev/dev/data/mnist_tiny/train/3/9324.png...]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It's often useful to be able to create functions with customized behavior. <code>fastai.data</code> generally uses functions named as CamelCase verbs ending in <code>er</code> to create these functions. <a href="/data.transforms.html#FileGetter"><code>FileGetter</code></a> is a simple example of such a function creator.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="FileGetter" class="doc_header"><code>FileGetter</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L43" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>FileGetter</code>(<strong><code>suf</code></strong>=<em><code>''</code></em>, <strong><code>extensions</code></strong>=<em><code>None</code></em>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>folders</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Create <a href="/data.transforms.html#get_files"><code>get_files</code></a> partial function that searches path suffix <code>suf</code>, only in <code>folders</code>, if specified, and passes along args</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fpng</span> <span class="o">=</span> <span class="n">FileGetter</span><span class="p">(</span><span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t7</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">fpng</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;7&#39;</span><span class="p">)))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">fpng</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span>
<span class="n">fpng_r</span> <span class="o">=</span> <span class="n">FileGetter</span><span class="p">(</span><span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">fpng_r</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_image_files" class="doc_header"><code>get_image_files</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L53" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_image_files</code>(<strong><code>path</code></strong>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>folders</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Get image files in <code>path</code> recursively, only in <code>folders</code>, if specified.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is simply <a href="/data.transforms.html#get_files"><code>get_files</code></a> called with a list of standard image extensions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">get_image_files</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">folders</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ImageGetter" class="doc_header"><code>ImageGetter</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L58" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ImageGetter</code>(<strong><code>suf</code></strong>=<em><code>''</code></em>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>folders</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Create <a href="/data.transforms.html#get_image_files"><code>get_image_files</code></a> partial function that searches path suffix <code>suf</code> and passes along <code>kwargs</code>, only in <code>folders</code>, if specified.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Same as <a href="/data.transforms.html#FileGetter"><code>FileGetter</code></a>, but for image extensions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">folders</span><span class="o">=</span><span class="s1">&#39;3&#39;</span><span class="p">)),</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">ImageGetter</span><span class="p">(</span>   <span class="s1">&#39;train&#39;</span><span class="p">,</span>                    <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">folders</span><span class="o">=</span><span class="s1">&#39;3&#39;</span><span class="p">)(</span><span class="n">path</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Split">Split<a class="anchor-link" href="#Split">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The next set of functions are used to <em>split</em> data into training and validation sets. The functions return two lists - a list of indices or masks for each of training and validation sets.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="RandomSplitter" class="doc_header"><code>RandomSplitter</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L64" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>RandomSplitter</code>(<strong><code>valid_pct</code></strong>=<em><code>0.2</code></em>, <strong><code>seed</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Create function that splits <code>items</code> between train/val with <code>valid_pct</code> randomly.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">src</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">RandomSplitter</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">trn</span><span class="p">,</span><span class="n">val</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
<span class="k">assert</span> <span class="mi">0</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">trn</span><span class="p">)</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">o</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">val</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">trn</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">trn</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
<span class="c1"># test random seed consistency</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">src</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">trn</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="GrandparentSplitter" class="doc_header"><code>GrandparentSplitter</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L77" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>GrandparentSplitter</code>(<strong><code>train_name</code></strong>=<em><code>'train'</code></em>, <strong><code>valid_name</code></strong>=<em><code>'valid'</code></em>)</p>
</blockquote>
<p>Split <code>items</code> from the grand parent folder names (<code>train_name</code> and <code>valid_name</code>).</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train/3/9932.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid/7/7189.png&#39;</span><span class="p">,</span> 
         <span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid/7/7320.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;train/7/9833.png&#39;</span><span class="p">,</span>  
         <span class="n">path</span><span class="o">/</span><span class="s1">&#39;train/3/7666.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid/3/925.png&#39;</span><span class="p">,</span>
         <span class="n">path</span><span class="o">/</span><span class="s1">&#39;train/7/724.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid/3/93055.png&#39;</span><span class="p">]</span>
<span class="n">splitter</span> <span class="o">=</span> <span class="n">GrandparentSplitter</span><span class="p">()</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">splitter</span><span class="p">(</span><span class="n">items</span><span class="p">),[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Label">Label<a class="anchor-link" href="#Label">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The final set of functions is used to <em>label</em> a single item of data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="parent_label" class="doc_header"><code>parent_label</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L84" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>parent_label</code>(<strong><code>o</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Label <code>item</code> with the parent folder name.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that <a href="/data.transforms.html#parent_label"><code>parent_label</code></a> doesn't have anything customize, so it doesn't return a function - you can just use it directly.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="n">parent_label</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;3&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">parent_label</span><span class="p">(</span><span class="s2">&quot;fastai_dev/dev/data/mnist_tiny/train/3/9932.png&quot;</span><span class="p">),</span> <span class="s1">&#39;3&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">parent_label</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">items</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;3&#39;, &#39;7&#39;, &#39;7&#39;, &#39;7&#39;, &#39;3&#39;, &#39;3&#39;, &#39;7&#39;, &#39;3&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="RegexLabeller" class="doc_header"><code>RegexLabeller</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L89" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>RegexLabeller</code>(<strong><code>pat</code></strong>)</p>
</blockquote>
<p>Label <code>item</code> with regex <code>pat</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/data.transforms.html#RegexLabeller"><code>RegexLabeller</code></a> is a very flexible function since it handles any regex search of the stringified item. For instance, here's an example the replicates the previous <a href="/data.transforms.html#parent_label"><code>parent_label</code></a> results.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">RegexLabeller</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;/(\d)/&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">parent_label</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;3&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">items</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;3&#39;, &#39;7&#39;, &#39;7&#39;, &#39;7&#39;, &#39;3&#39;, &#39;3&#39;, &#39;7&#39;, &#39;3&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CategoryMap" class="doc_header"><code>class</code> <code>CategoryMap</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L99" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CategoryMap</code>(<strong><code>col</code></strong>, <strong><code>sort</code></strong>=<em><code>True</code></em>, <strong><code>add_na</code></strong>=<em><code>False</code></em>) :: <a href="/core.html#CollBase"><code>CollBase</code></a></p>
</blockquote>
<p>Collection of categories with the reverse mapping in <code>o2i</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">CategoryMap</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">,</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="n">test_fail</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">[</span><span class="s1">&#39;unseen label&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">CategoryMap</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">add_na</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;#na#&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;#na#&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">3</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">CategoryMap</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">,</span> <span class="p">{</span><span class="mi">4</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">col</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">([</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;H&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">],</span> <span class="n">categories</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">],</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">CategoryMap</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Category" class="doc_header"><code>class</code> <code>Category</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L113" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Category</code>() :: <code>str</code></p>
</blockquote>
<p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to sys.getdefaultencoding().
errors defaults to 'strict'.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span><span class="o">=</span><span class="n">L</span><span class="p">([</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">sum</span><span class="p">(</span><span class="n">t</span><span class="p">,[])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[1, 2, 3]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Categorize" class="doc_header"><code>class</code> <code>Categorize</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L116" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Categorize</code>(<strong><code>vocab</code></strong>=<em><code>None</code></em>, <strong><code>add_na</code></strong>=<em><code>False</code></em>) :: <a href="/transform.html#Transform"><code>Transform</code></a></p>
</blockquote>
<p>Reversible transform of category string to <code>vocab</code> id</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat</span> <span class="o">=</span> <span class="n">Category</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
<span class="n">tds</span> <span class="o">=</span> <span class="n">DataSource</span><span class="p">([</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">],</span> <span class="n">tfms</span><span class="o">=</span><span class="p">[</span><span class="n">cat</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;dog&#39;</span><span class="p">)</span>
<span class="n">test_stdout</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">show_at</span><span class="p">(</span><span class="n">tds</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;cat&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat</span> <span class="o">=</span> <span class="n">Category</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">add_na</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">tds</span> <span class="o">=</span> <span class="n">DataSource</span><span class="p">([</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">],</span> <span class="n">tfms</span><span class="o">=</span><span class="p">[</span><span class="n">cat</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;#na#&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;dog&#39;</span><span class="p">)</span>
<span class="n">test_stdout</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">show_at</span><span class="p">(</span><span class="n">tds</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;cat&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MultiCategory" class="doc_header"><code>class</code> <code>MultiCategory</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L133" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MultiCategory</code>(<strong><code>items</code></strong>=<em><code>None</code></em>, <strong>*<code>rest</code></strong>, <strong><code>use_list</code></strong>=<em><code>False</code></em>, <strong><code>match</code></strong>=<em><code>None</code></em>) :: <a href="/core.html#L"><code>L</code></a></p>
</blockquote>
<p>Behaves like a list of <code>items</code> but can also index with list of indices or masks</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MultiCategorize" class="doc_header"><code>class</code> <code>MultiCategorize</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L137" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MultiCategorize</code>(<strong><code>vocab</code></strong>=<em><code>None</code></em>, <strong><code>add_na</code></strong>=<em><code>False</code></em>) :: <a href="/data.transforms.html#Categorize"><code>Categorize</code></a></p>
</blockquote>
<p>Reversible transform of multi-category strings to <code>vocab</code> id</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat</span> <span class="o">=</span> <span class="n">MultiCategorize</span><span class="p">()</span>
<span class="n">tds</span> <span class="o">=</span> <span class="n">DataSource</span><span class="p">([[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]],</span> <span class="n">tfms</span><span class="o">=</span><span class="p">[</span><span class="n">cat</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="p">([]),</span> <span class="p">[])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">decode</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">decode</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="n">test_stdout</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">show_at</span><span class="p">(</span><span class="n">tds</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;a;c&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="OneHotEncode" class="doc_header"><code>class</code> <code>OneHotEncode</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L155" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>OneHotEncode</code>(<strong><code>do_encode</code></strong>=<em><code>True</code></em>, <strong><code>vocab</code></strong>=<em><code>None</code></em>) :: <a href="/transform.html#Transform"><code>Transform</code></a></p>
</blockquote>
<p>One-hot encodes targets and optionally decodes with <code>vocab</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Works in conjunction with <code>MultiCategorize</code> or on its own if you have one-hot encoded targets (pass a <code>vocab</code> for decoding and <code>do_encode=False</code> in this case)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_tfm</span> <span class="o">=</span> <span class="n">OneHotEncode</span><span class="p">(</span><span class="n">vocab</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="n">tds</span> <span class="o">=</span> <span class="n">DataSource</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">tfms</span><span class="o">=</span><span class="p">[</span><span class="n">_tfm</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">_tfm</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">byte</span><span class="p">())</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">_tfm</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])),</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_tfm</span> <span class="o">=</span> <span class="n">OneHotEncode</span><span class="p">(</span><span class="n">vocab</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="n">do_encode</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">tds</span> <span class="o">=</span> <span class="n">DataSource</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span> <span class="n">tfms</span><span class="o">=</span><span class="p">[</span><span class="n">_tfm</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">_tfm</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">byte</span><span class="p">())</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">_tfm</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])),</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tds</span> <span class="o">=</span> <span class="n">DataSource</span><span class="p">([[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]],</span> <span class="p">[[</span><span class="n">MultiCategorize</span><span class="p">(),</span> <span class="n">OneHotEncode</span><span class="p">()]])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">tds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">byte</span><span class="p">()])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">tds</span><span class="o">.</span><span class="n">decode</span><span class="p">([</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])]),</span> <span class="p">[[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">]])</span>
<span class="n">test_stdout</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">show_at</span><span class="p">(</span><span class="n">tds</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;a;c&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_c" class="doc_header"><code>get_c</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L169" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_c</code>(<strong><code>dbunch</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="End-to-end-dataset-example-with-MNIST">End-to-end dataset example with MNIST<a class="anchor-link" href="#End-to-end-dataset-example-with-MNIST">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's show how to use those functions to grab the mnist dataset in a <a href="/data.core.html#DataSource"><code>DataSource</code></a>. First we grab all the images.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST_TINY</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">get_image_files</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then we split between train and validation depending on the folder.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splitter</span> <span class="o">=</span> <span class="n">GrandparentSplitter</span><span class="p">()</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">splitter</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">train</span><span class="p">,</span><span class="n">valid</span> <span class="o">=</span> <span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">splits</span><span class="p">)</span>
<span class="n">train</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span><span class="n">valid</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((#3) [/home/sgugger/git/fastai_dev/dev/data/mnist_tiny/train/3/8055.png,/home/sgugger/git/fastai_dev/dev/data/mnist_tiny/train/3/9466.png,/home/sgugger/git/fastai_dev/dev/data/mnist_tiny/train/3/7778.png],
 (#3) [/home/sgugger/git/fastai_dev/dev/data/mnist_tiny/valid/3/957.png,/home/sgugger/git/fastai_dev/dev/data/mnist_tiny/valid/3/9073.png,/home/sgugger/git/fastai_dev/dev/data/mnist_tiny/valid/3/8939.png])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our inputs are images that we open and convert to tensors, our targets are labeled depending on the parent directory and are categories.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>
<span class="k">def</span> <span class="nf">open_img</span><span class="p">(</span><span class="n">fn</span><span class="p">:</span><span class="n">Path</span><span class="p">):</span> <span class="k">return</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">img2tensor</span><span class="p">(</span><span class="n">im</span><span class="p">:</span><span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">):</span> <span class="k">return</span> <span class="n">TensorImage</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="n">im</span><span class="p">)[</span><span class="kc">None</span><span class="p">])</span>

<span class="n">tfms</span> <span class="o">=</span> <span class="p">[[</span><span class="n">open_img</span><span class="p">,</span> <span class="n">img2tensor</span><span class="p">],</span>
        <span class="p">[</span><span class="n">parent_label</span><span class="p">,</span> <span class="n">Categorize</span><span class="p">()]]</span>
<span class="n">train_ds</span> <span class="o">=</span> <span class="n">DataSource</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">tfms</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">train_ds</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="n">xd</span><span class="p">,</span><span class="n">yd</span> <span class="o">=</span> <span class="n">decode_at</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">parent_label</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span><span class="n">yd</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="mi">3</span><span class="p">])),</span><span class="n">xd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">show_at</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greys&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABUCAYAAAA7xZEpAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAEeUlEQVR4nO3bX4iNeRzH8dfPUNQQZUZpUDY1tWVTwlJMLuzFElLaDRfKjVwgN1yIGtSUq73YG4mylCxJoVxoL5a4WDdM1rZhS4iQKeTPevZi9pkz85vDnDHnzHPW/t51Ouc5v/M8z7fP+Tzf3+/3/T1PyLJMosSIogOoN5IgEUmQiCRIRBIkIgkSkQSJKFyQEMJPIYQHIYSuEMIfIYQNhcZT9MAshPAl/syy7HUIoRW/4Nssy34rIp7CHZJlWWeWZa/zzX9fXxQVT+GCQAjhxxDCS/yOBzhXWCxFXzI5IYQGfI02dGRZ9raIOOrCIZBl2d9Zlv2KFmwsKo66EaQXI/1fc0gIoTmE8F0IoTGE0BBC+Abf42JhMRWZQ0IITfgZX+n+c/7CD1mWHSgspnpJqvVCPeaQQkmCRCRBIpIgESMHaP+cM24o92VySEQSJCIJEpEEiUiCRCRBIpIgEQONQ4aNFy9egIMHD4LNmzeD1atXg2PHjoGGhoaaxpEcEjHQ9L+mI9VLly6BV69e6ejoABcvlq8NdXZ2gtbW1mqdPo1UK2FYc8jjx4/BkSNHwI4dO8C7d+8G3PfGjRuoqkPKkhwSMSw55OjRo2DXrl3gzp07fdonTJjQ8/nZs2d92qZNmwZu3boFRo0aVY2QSDmkMoYlhzx58gT9nbF+/XqwdetW27dvB+fO9V3F3LZtG6rqjI+SHBIxLA7ZtGkTuH79Oli2bBlYsmQJaG9v7+eMsWPHgqVLlw5HiD0kh0QUMlK9ffs22LdvHzh06FBP2/jx48G1a9dQ6mVqQOplKqEQhzQ2NqJ7DhOTz2UWLVpUi1P3JjmkEgpxyJgxY8CbN2/6tU2cOBFs3Nh9z8zixYvBggULUNV6SHJIJdSdQz7EnDlzwP79+0FLSwuG1AuVdUghgty8eROcPn0aLF++vKft8OHD4OrVq332uXfvHrh79y5YsWIFOHny5KeGkS6ZSii0hDgYnj59Ctra2lCaMOZOyi+hQZAcUgk1cUh+zPx9xIjq6Z47Yv78+dBTNti7d+9gD5UcUglVnf6fOXMG3L9/H6xcuRJMmjSpauc4e/Zsn+0LFy7gkxxSluSQiKrmkNmzZ4OmpiZw/vz5T42rHw8fPgSzZs0Cjx49ApcvXwZz584d7CFTDqmEquSQK1euoLTcmI8VhsL79+/B7t27wYED3Xd7587I89LkyZOHfK7eJIdEVMUhM2fOBFOnTkXJMevWrQM7d+7s8/sZM2agNC95+7b0rFC+zJkf40OL32vXrgVTpkwZcvy9SQ6JqGovs2rVKpRmsR9izZo14NSpUyhfSozJC0fHjx8H8+bNA6NHjx5MiL1JvUwlVNUhXV1dKN3+1N7eDp4/f47KnJDPe5qbm1Fy3ZYtW8D06dMHE9LHSA6phGGph+Q3u+zZswecOHECLFy4EGzYUHq6fdy4cSgtd9aQ5JBK+M9UzGpAckglJEEikiARSZCIJEhEEiQiCRIxUD2kbF/9OZMcEpEEiUiCRCRBIpIgEUmQiH8AXEReOybNeDQAAAAASUVORK5CYII=
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;7&#39;</span><span class="p">)</span>
<span class="n">test_fig_exists</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ToTensor" class="doc_header"><code>class</code> <code>ToTensor</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L173" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ToTensor</code>(<strong><code>enc</code></strong>=<em><code>None</code></em>, <strong><code>dec</code></strong>=<em><code>None</code></em>, <strong><code>split_idx</code></strong>=<em><code>None</code></em>, <strong><code>as_item</code></strong>=<em><code>False</code></em>) :: <a href="/transform.html#Transform"><code>Transform</code></a></p>
</blockquote>
<p>Convert item to appropriate tensor class</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Cuda" class="doc_header"><code>class</code> <code>Cuda</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L179" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Cuda</code>(<strong><code>device</code></strong>=<em><code>None</code></em>) :: <a href="/transform.html#Transform"><code>Transform</code></a></p>
</blockquote>
<p>Move batch to <a href="https://pytorch.org/docs/stable/tensor_attributes.html#torch-device"><code>device</code></a> (defaults to <code>default_device()</code>)</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Cuda.encodes" class="doc_header"><code>Cuda.encodes</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L184" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Cuda.encodes</code>()</p>
</blockquote>
<p>Move batch to <a href="https://pytorch.org/docs/stable/tensor_attributes.html#torch-device"><code>device</code></a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that, like all <a href="/transform.html#Transform"><code>Transform</code></a>s, <a href="/tabular.rapids.html#encodes"><code>encodes</code></a> is called by <code>tfm()</code> and <code>decodes</code> is called by <code>tfm.decode()</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tfm</span> <span class="o">=</span> <span class="n">Cuda</span><span class="p">()</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">tfm</span><span class="p">((</span><span class="n">tensor</span><span class="p">(</span><span class="mi">1</span><span class="p">),))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="o">*</span><span class="n">t</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span><span class="s1">&#39;torch.cuda.LongTensor&#39;</span> <span class="k">if</span> <span class="n">default_device</span><span class="p">()</span><span class="o">.</span><span class="n">type</span><span class="o">==</span><span class="s1">&#39;cuda&#39;</span> <span class="k">else</span> <span class="s1">&#39;torch.LongTensor&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Cuda.decodes" class="doc_header"><code>Cuda.decodes</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L185" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Cuda.decodes</code>()</p>
</blockquote>
<p>Return batch to CPU</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">tfm</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="o">*</span><span class="n">t</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span><span class="s1">&#39;torch.LongTensor&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span> 
    <span class="k">def</span> <span class="nf">encodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span> 
    <span class="k">def</span> <span class="nf">decodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">Int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> 
    
<span class="n">start</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="n">tds</span> <span class="o">=</span> <span class="n">DataSource</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="p">[</span><span class="n">A</span><span class="p">()])</span>
<span class="n">tdl</span> <span class="o">=</span> <span class="n">TfmdDL</span><span class="p">(</span><span class="n">tds</span><span class="p">,</span> <span class="n">after_batch</span><span class="o">=</span><span class="n">Cuda</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">tdl</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="n">default_device</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ByteToFloatTensor" class="doc_header"><code>class</code> <code>ByteToFloatTensor</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L190" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ByteToFloatTensor</code>(<strong><code>div</code></strong>=<em><code>True</code></em>, <strong><code>div_mask</code></strong>=<em><code>False</code></em>, <strong><code>split_idx</code></strong>=<em><code>None</code></em>, <strong><code>as_item</code></strong>=<em><code>True</code></em>) :: <a href="/transform.html#Transform"><code>Transform</code></a></p>
</blockquote>
<p>Transform image to float tensor, optionally dividing by 255 (e.g. for images).</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">TensorImage</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span><span class="n">tensor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">long</span><span class="p">(),</span><span class="n">TensorMask</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<span class="n">tfm</span> <span class="o">=</span> <span class="n">ByteToFloatTensor</span><span class="p">(</span><span class="n">as_item</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ft</span> <span class="o">=</span> <span class="n">tfm</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ft</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">TensorImage</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">TensorMask</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span><span class="s1">&#39;torch.FloatTensor&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span><span class="s1">&#39;torch.LongTensor&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span><span class="s1">&#39;torch.LongTensor&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Normalize" class="doc_header"><code>class</code> <code>Normalize</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L203" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Normalize</code>(<strong><code>mean</code></strong>, <strong><code>std</code></strong>) :: <a href="/transform.html#Transform"><code>Transform</code></a></p>
</blockquote>
<p>Normalize/denorm batch of <a href="/transform.html#TensorImage"><code>TensorImage</code></a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="broadcast_vec" class="doc_header"><code>broadcast_vec</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L213" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>broadcast_vec</code>(<strong><code>dim</code></strong>, <strong><code>ndim</code></strong>, <strong>*<code>t</code></strong>, <strong><code>cuda</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Make a vector broadcastable over <code>dim</code> (out of <code>ndim</code> total) by prepending and appending unit axes</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mean</span><span class="p">,</span><span class="n">std</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,[</span><span class="mf">0.5</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span>
<span class="n">mean</span><span class="p">,</span><span class="n">std</span> <span class="o">=</span> <span class="n">broadcast_vec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>
<span class="n">dl_tfms</span> <span class="o">=</span> <span class="p">[</span><span class="n">Cuda</span><span class="p">(),</span> <span class="n">ByteToFloatTensor</span><span class="p">(),</span> <span class="n">Normalize</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span><span class="n">std</span><span class="p">)]</span>
<span class="n">tdl</span> <span class="o">=</span> <span class="n">TfmdDL</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span> <span class="n">after_batch</span><span class="o">=</span><span class="n">dl_tfms</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span>  <span class="o">=</span> <span class="n">tdl</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">xd</span><span class="p">,</span><span class="n">yd</span> <span class="o">=</span> <span class="n">tdl</span><span class="o">.</span><span class="n">after_batch</span><span class="o">.</span><span class="n">decode</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>

<span class="n">test_eq</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span> <span class="s1">&#39;torch.cuda.FloatTensor&#39;</span> <span class="k">if</span> <span class="n">default_device</span><span class="p">()</span><span class="o">.</span><span class="n">type</span><span class="o">==</span><span class="s1">&#39;cuda&#39;</span> <span class="k">else</span> <span class="s1">&#39;torch.FloatTensor&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">xd</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span> <span class="s1">&#39;torch.FloatTensor&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">&lt;</span><span class="mf">0.0</span>
<span class="k">assert</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">&gt;</span><span class="mf">0.5</span>
<span class="k">assert</span> <span class="mi">0</span><span class="o">&lt;</span><span class="n">xd</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">/</span><span class="mf">255.</span><span class="o">&lt;</span><span class="mi">1</span>
<span class="k">assert</span> <span class="mi">0</span><span class="o">&lt;</span><span class="n">xd</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">/</span><span class="mf">255.</span><span class="o">&lt;</span><span class="mf">0.5</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tdl</span><span class="o">.</span><span class="n">show_batch</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">torch</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#Lose type of tensors (to emulate predictions)</span>
<span class="n">test_ne</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">TensorImage</span><span class="p">)</span>
<span class="n">tdl</span><span class="o">.</span><span class="n">show_batch</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="c1">#Check that types are put back by dl.</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#TODO: make the above check a proper test</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>
 

