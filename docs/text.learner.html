---

title: Text learner
keywords: fastai
sidebar: home_sidebar

summary: "Convenience functions to easily create a [`Learner`](/learner.html#Learner) for text applications"
---
<!--


#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: dev/37_text_learner.ipynb
# instructions: https://docs.fast.ai/gen_doc_main.html

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">local.notebook.showdoc</span> <span class="k">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="match_embeds" class="doc_header"><code>match_embeds</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/text/learner.py#L22" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>match_embeds</code>(<strong><code>old_wgts</code></strong>, <strong><code>old_vocab</code></strong>, <strong><code>new_vocab</code></strong>)</p>
</blockquote>
<p>Convert the embedding in <code>wgts</code> to go with a new vocabulary.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wgts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;0.encoder.weight&#39;</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">)}</span>
<span class="n">new_wgts</span> <span class="o">=</span> <span class="n">match_embeds</span><span class="p">(</span><span class="n">wgts</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="n">old</span><span class="p">,</span><span class="n">new</span> <span class="o">=</span> <span class="n">wgts</span><span class="p">[</span><span class="s1">&#39;0.encoder.weight&#39;</span><span class="p">],</span><span class="n">new_wgts</span><span class="p">[</span><span class="s1">&#39;0.encoder.weight&#39;</span><span class="p">]</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">old</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">old</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">old</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">old</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#With bias</span>
<span class="n">wgts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;0.encoder.weight&#39;</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;1.decoder.bias&#39;</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">)}</span>
<span class="n">new_wgts</span> <span class="o">=</span> <span class="n">match_embeds</span><span class="p">(</span><span class="n">wgts</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="n">old_w</span><span class="p">,</span><span class="n">new_w</span> <span class="o">=</span> <span class="n">wgts</span><span class="p">[</span><span class="s1">&#39;0.encoder.weight&#39;</span><span class="p">],</span><span class="n">new_wgts</span><span class="p">[</span><span class="s1">&#39;0.encoder.weight&#39;</span><span class="p">]</span>
<span class="n">old_b</span><span class="p">,</span><span class="n">new_b</span> <span class="o">=</span> <span class="n">wgts</span><span class="p">[</span><span class="s1">&#39;1.decoder.bias&#39;</span><span class="p">],</span>  <span class="n">new_wgts</span><span class="p">[</span><span class="s1">&#39;1.decoder.bias&#39;</span><span class="p">]</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">new_w</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">old_w</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">new_w</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">old_w</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">new_w</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">old_w</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">new_w</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">old_w</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">new_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">old_b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">new_b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">old_b</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">new_b</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">old_b</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">new_b</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">old_b</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RNNLearner" class="doc_header"><code>class</code> <code>RNNLearner</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/text/learner.py#L43" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RNNLearner</code>(<strong><code>model</code></strong>, <strong><code>dbunch</code></strong>, <strong><code>loss_func</code></strong>, <strong><code>alpha</code></strong>=<em><code>2.0</code></em>, <strong><code>beta</code></strong>=<em><code>1.0</code></em>, <strong><code>opt_func</code></strong>=<em><code>'SGD'</code></em>, <strong><code>lr</code></strong>=<em><code>slice(None, 0.003, None)</code></em>, <strong><code>splitter</code></strong>=<em><code>'trainable_params'</code></em>, <strong><code>cbs</code></strong>=<em><code>None</code></em>, <strong><code>cb_funcs</code></strong>=<em><code>None</code></em>, <strong><code>metrics</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>, <strong><code>model_dir</code></strong>=<em><code>'models'</code></em>, <strong><code>wd_bn_bias</code></strong>=<em><code>False</code></em>, <strong><code>train_bn</code></strong>=<em><code>True</code></em>) :: <a href="/learner.html#Learner"><code>Learner</code></a></p>
</blockquote>
<p>Basic class for a <a href="/learner.html#Learner"><code>Learner</code></a> in NLP.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="language_model_learner" class="doc_header"><code>language_model_learner</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/text/learner.py#L80" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>language_model_learner</code>(<strong><code>dbunch</code></strong>, <strong><code>arch</code></strong>, <strong><code>vocab</code></strong>, <strong><code>config</code></strong>=<em><code>None</code></em>, <strong><code>drop_mult</code></strong>=<em><code>1.0</code></em>, <strong><code>pretrained</code></strong>=<em><code>True</code></em>, <strong><code>pretrained_fnames</code></strong>=<em><code>None</code></em>, <strong><code>loss_func</code></strong>=<em><code>None</code></em>, <strong><code>opt_func</code></strong>=<em><code>'SGD'</code></em>, <strong><code>lr</code></strong>=<em><code>slice(None, 0.003, None)</code></em>, <strong><code>splitter</code></strong>=<em><code>'trainable_params'</code></em>, <strong><code>cbs</code></strong>=<em><code>None</code></em>, <strong><code>cb_funcs</code></strong>=<em><code>None</code></em>, <strong><code>metrics</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>, <strong><code>model_dir</code></strong>=<em><code>'models'</code></em>, <strong><code>wd_bn_bias</code></strong>=<em><code>False</code></em>, <strong><code>train_bn</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Create a <a href="/learner.html#Learner"><code>Learner</code></a> with a language model from <code>data</code> and <code>arch</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="text_classifier_learner" class="doc_header"><code>text_classifier_learner</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/text/learner.py#L102" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>text_classifier_learner</code>(<strong><code>dbunch</code></strong>, <strong><code>arch</code></strong>, <strong><code>vocab</code></strong>, <strong><code>bptt</code></strong>=<em><code>72</code></em>, <strong><code>config</code></strong>=<em><code>None</code></em>, <strong><code>pretrained</code></strong>=<em><code>True</code></em>, <strong><code>drop_mult</code></strong>=<em><code>1.0</code></em>, <strong><code>lin_ftrs</code></strong>=<em><code>None</code></em>, <strong><code>ps</code></strong>=<em><code>None</code></em>, <strong><code>loss_func</code></strong>=<em><code>None</code></em>, <strong><code>opt_func</code></strong>=<em><code>'SGD'</code></em>, <strong><code>lr</code></strong>=<em><code>slice(None, 0.003, None)</code></em>, <strong><code>splitter</code></strong>=<em><code>'trainable_params'</code></em>, <strong><code>cbs</code></strong>=<em><code>None</code></em>, <strong><code>cb_funcs</code></strong>=<em><code>None</code></em>, <strong><code>metrics</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>, <strong><code>model_dir</code></strong>=<em><code>'models'</code></em>, <strong><code>wd_bn_bias</code></strong>=<em><code>False</code></em>, <strong><code>train_bn</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Create a <a href="/learner.html#Learner"><code>Learner</code></a> with a text classifier from <code>data</code> and <code>arch</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
</div>
 

